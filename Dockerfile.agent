# 1. 使用一个基础的 Python 镜像
FROM python:3.11-slim

# 2. 设置工作目录
WORKDIR /app

# 3. 安装核心依赖
#    - gcc/g++ (用于编译某些 Python 包)
#    - jupyter_client 和 ipykernel (我们的核心)
#    - matplotlib, pandas, scikit-learn (银行 Agent 需要的基础库)
RUN apt-get update && apt-get install -y \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

RUN pip install --no-cache-dir jupyter_client ipykernel \
    pandas scikit-learn matplotlib shap fairlearn

# 4. (关键) 当容器启动时，自动启动一个 Jupyter 内核
#    - 它会将连接文件 'kernel.json' 创建在 /app 目录
#    - 它会监听来自所有 IP (0.0.0.0) 的连接，而不仅仅是 localhost
CMD ["python", "-m", "ipykernel_launcher", \
     "-f", "/app/kernel.json", \
     "--ip=0.0.0.0"]